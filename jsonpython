import json
jsonFile = open('json_kafka.json', 'r')
values = json.load(jsonFile)
dictionary_ctoc=values["main-grouping-json
parsed_field1=dictionary_ctoc["Source field"]
# Source field
print(parsed_field1)
jsonFile.close()


https://stackoverflow.com/questions/12934699/selecting-fields-from-json-output
how to call the endpoint to send the data?

ssh to a system, get the output from a command
https://askubuntu.com/questions/917200/how-to-redirect-command-output-from-remote-machine-to-local-file-via-ssh?rq=1

import json

def get_values_from_json():
    jsonFile = open('json_kafka.json', 'r')
    dict_from_json = json.load(jsonFile)
    for primaryKey in dict_from_json:
        if str(primaryKey).startswith("ls-"):
            newPrimaryKey = "{}-v1".format(primaryKey)
            shipper_port = dict_from_json[primaryKey]["ShipperPort"]
            command = "/ctoc/vendor-kafka/bin/kafka-console-consumer.sh --bootstrap-server blabla.com:80 --consumer.config /ctoc/app-common/ssl/kafka_client.properties --topic " + newPrimaryKey + " --from beginning | grep CONFIG"
            print(command)
            print(shipper_port)


get_values_from_json()
==============================================================
def get_values_from_json():
    jsonString = open('json_kafka.json', 'r')
    count = 0
    dict_from_json = json.load(jsonString)
    for primaryKey in dict_from_json:
        if str(primaryKey).startswith("ls-"):
            newPrimaryKey = "{}-v1".format(primaryKey)
            shipper_port = dict_from_json[primaryKey]["ShipperPort"]
            if count == 2:
                break
            else:

                rakhi = (["/ctoc/vendor-kafka/bin/kafka-console-consumer.sh", "--bootstrap-server blabla.com:80", "--consumer.config", "/ctoc/app-common/ssl/kafka_client.properties", "--topic ", newPrimaryKey , " --from beginning"])

                code, output, error = execute_shell_command(shell_command=rakhi)
                Dict_output = json.load(output)
                parsed_message = Dict_output["message"]
                count += 1
                return parsed_message

get_values_from_json()
